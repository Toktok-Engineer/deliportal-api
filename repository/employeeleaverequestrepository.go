package repository

import (
	"deliportal-api/model"
	"strconv"
	"strings"

	"gorm.io/gorm"
)

type EmployeeLeaveRequestRepository interface {
	CountEmployeeLeaveRequestAll(empId int) (count int64, err error)
	CountEmployeeLeaveRequestApprovalAllDt(year string) (count int64, err error)
	FindEmployeeLeaveRequests() (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestsOffset(limit int, offset int, order string, dir string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	SearchEmployeeLeaveRequest(limit int, offset int, order string, dir string, search string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	CountSearchEmployeeLeaveRequest(search string, empId int) (count int64, err error)
	FindEmployeeLeaveRequestById(id uint) (employeeLeaveRequestOutput model.SelectEmployeeLeaveRequestParameter, err error)
	CountEmployeeLeaveRequestAllPIC(empId int) (count int64, err error)
	FindEmployeeLeaveRequestsPICOffset(limit int, offset int, order string, dir string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error)
	CountSearchEmployeeLeaveRequestPIC(search string, empId int) (count int64, err error)
	SearchEmployeeLeaveRequestPIC(limit int, offset int, order string, dir string, search string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error)
	FindEmployeeLeaveRequestPICById(id uint) (employeeLeaveRequestOutput model.SelectEmployeeLeaveRequestPICParameter, err error)
	CountEmployeeLeaveRequestDaftarCuti() (count int64, err error)
	FindEmployeeLeaveRequestsDaftarCutiOffset(limit int, offset int, order string, dir string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	SearchEmployeeLeaveRequestDaftarCuti(limit int, offset int, order string, dir string, search string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	CountSearchEmployeeLeaveRequestDaftarCuti(search string) (count int64, err error)
	FindEmployeeLeaveRequestByEmpId(empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestByEmpIdDate(empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestByEmpIdExcDate(elrId uint, empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestDraftOrAFA(empId uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestPeriodDate(date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	CountEmployeeLeaveRequestPersonaliaAllPIC() (count int64, err error)
	FindEmployeeLeaveRequestsPersonaliaPICOffset(limit int, offset int, order string, dir string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error)
	CountSearchEmployeeLeaveRequestPersonaliaPIC(search string) (count int64, err error)
	SearchEmployeeLeaveRequestPersonaliaPIC(limit int, offset int, order string, dir string, search string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error)
	FindAllEmployeeLeaveRequestByEmpId(empId uint, year string, date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestFromDate(date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestToDate(date float64, date2 float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindEmployeeLeaveRequestDate(date float64, date2 float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	FindAllEmployeeLeaveRequestByEmpIdDate(empId uint, year string, date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	// FindExcEmployeeLeaveRequest(nwtId uint, id uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	// FindEmployeeLeaveRequestByNWTId(nwtId uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error)
	// CountEmployeeLeaveRequestName(search string) (count int64, err error)
	InsertEmployeeLeaveRequest(employeeLeaveRequest model.EmployeeLeaveRequest) (employeeLeaveRequestOutput model.EmployeeLeaveRequest, err error)
	UpdateEmployeeLeaveRequest(employeeLeaveRequest model.EmployeeLeaveRequest, id uint) (employeeLeaveRequestOutput model.EmployeeLeaveRequest, err error)
}

type EmployeeLeaveRequestConnection struct {
	connection *gorm.DB
}

func NewEmployeeLeaveRequestRepository(db *gorm.DB) EmployeeLeaveRequestRepository {
	return &EmployeeLeaveRequestConnection{
		connection: db,
	}
}

func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestAll(empId int) (count int64, err error) {
	res := db.connection.Table("employee_leave_requests").Where("employee_id = ? AND deleted_at = 0", empId).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestApprovalAllDt(year string) (count int64, err error) {
	final := "%" + strings.ToLower(year) + "%"
	res := db.connection.Table("employee_leave_requests").Where("employee_leave_request_no LIKE ?", final).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequests() (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.deleted_at = 0").Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestsOffset(limit int, offset int, order string, dir string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		orderDirection          string
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	orderDirection = order + " " + dir
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND employee_leave_requests.deleted_at = 0", empId).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) SearchEmployeeLeaveRequest(limit int, offset int, order string, dir string, search string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		orderDirection          string
		final                   string
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	orderDirection = order + " " + dir
	final = "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ?) AND employee_leave_requests.employee_id = ? AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountSearchEmployeeLeaveRequest(search string, empId int) (count int64, err error) {
	final := "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ? ) AND employee_leave_requests.employee_id = ? AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestById(id uint) (employeeLeaveRequestOutput model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employeeLeaveRequest model.SelectEmployeeLeaveRequestParameter
	)

	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.id=? AND employee_leave_requests.deleted_at = 0", id).Take(&employeeLeaveRequest)
	return employeeLeaveRequest, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestAllPIC(empId int) (count int64, err error) {
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", empId).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestsPICOffset(limit int, offset int, order string, dir string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error) {
	var (
		orderDirection          string
		employee_leave_requests []model.SelectEmployeeLeaveRequestPICParameter
	)
	orderDirection = order + " " + dir
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, CONCAT(CONCAT(emp.firstname, ' '), emp.lastname) as current_approval_employee_name, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", empId).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) SearchEmployeeLeaveRequestPIC(limit int, offset int, order string, dir string, search string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error) {
	var (
		orderDirection          string
		final                   string
		employee_leave_requests []model.SelectEmployeeLeaveRequestPICParameter
	)
	orderDirection = order + " " + dir
	final = "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, CONCAT(CONCAT(emp.firstname, ' '), emp.lastname) as current_approval_employee_name, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ?) AND employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountSearchEmployeeLeaveRequestPIC(search string, empId int) (count int64, err error) {
	final := "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ? ) AND employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestPICById(id uint) (employeeLeaveRequestOutput model.SelectEmployeeLeaveRequestPICParameter, err error) {
	var (
		employeeLeaveRequest model.SelectEmployeeLeaveRequestPICParameter
	)

	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, CONCAT(CONCAT(emp.firstname, ' '), emp.lastname) as current_approval_employee_name, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("right join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("employee_leave_requests.id=? AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", id).Take(&employeeLeaveRequest)
	return employeeLeaveRequest, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestDaftarCuti() (count int64, err error) {
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status=3 AND employee_leave_requests.deleted_at = 0 AND date(now()) <= date(timezone('Asia/Jakarta', to_timestamp(employee_leave_requests.leave_to)))").Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestsDaftarCutiOffset(limit int, offset int, order string, dir string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		orderDirection          string
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	orderDirection = order + " " + dir
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status=3 AND employee_leave_requests.deleted_at = 0 AND date(now()) <= date(timezone('Asia/Jakarta', to_timestamp(employee_leave_requests.leave_to)))").Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) SearchEmployeeLeaveRequestDaftarCuti(limit int, offset int, order string, dir string, search string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		orderDirection          string
		final                   string
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	orderDirection = order + " " + dir
	final = "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employees.firstname) LIKE ? OR lower(employees.lastname) LIKE ? OR lower(employee_leave_requests.phone_number) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ?) AND employee_leave_requests.status=3 AND employee_leave_requests.deleted_at = 0 AND date(now()) <= date(timezone('Asia/Jakarta', to_timestamp(employee_leave_requests.leave_to)))", final, final, final, final, final, final, final).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountSearchEmployeeLeaveRequestDaftarCuti(search string) (count int64, err error) {
	final := "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employees.firstname) LIKE ? OR lower(employees.lastname) LIKE ? OR lower(employee_leave_requests.phone_number) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ?) AND employee_leave_requests.status=3 AND employee_leave_requests.deleted_at = 0 AND date(now()) <= date(timezone('Asia/Jakarta', to_timestamp(employee_leave_requests.leave_to)))", final, final, final, final, final, final, final).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestByEmpId(empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
		final                   string
	)
	final = "%" + strings.ToLower(year) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("right join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND employee_leave_requests.status=3 AND employee_leave_requests.deleted_at = 0 AND (to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'YYYY') LIKE ? OR to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'YYYY') LIKE ?)", empId, final, final).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestByEmpIdDate(empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
		final                   string
		final2                  string
	)
	final = "%" + strings.ToLower(year) + "%"
	num, _ := strconv.Atoi(year)
	num = num + 1
	final2 = "%" + strings.ToLower(strconv.Itoa(num)) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND (employee_leave_requests.status=1 OR employee_leave_requests.status=2 OR employee_leave_requests.status=3 OR employee_leave_requests.status=6) AND employee_leave_requests.deleted_at = 0 AND (to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'YYYY') LIKE ? OR to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'YYYY') LIKE ?)", empId, final, final2).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestByEmpIdExcDate(elrId uint, empId uint, year string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
		final                   string
	)
	final = "%" + strings.ToLower(year) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.id != ? AND employee_leave_requests.employee_id = ? AND (employee_leave_requests.status=1 OR employee_leave_requests.status=2 OR employee_leave_requests.status=3) AND employee_leave_requests.deleted_at = 0 AND (to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'YYYY') LIKE ? OR to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'YYYY') LIKE ?)", elrId, empId, final, final).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestDraftOrAFA(empId uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND (employee_leave_requests.status=1 OR employee_leave_requests.status=2) AND employee_leave_requests.deleted_at = 0 AND employee_leave_requests.leave_type_id = 1", empId).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestPeriodDate(date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(employee_leave_requests.status=1 OR employee_leave_requests.status=2 OR employee_leave_requests.status=3) AND employee_leave_requests.deleted_at = 0 AND employee_leave_requests.leave_from <= ? AND employee_leave_requests.leave_to >= ?", date, date).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestPersonaliaAllPIC() (count int64, err error) {
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0").Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestsPersonaliaPICOffset(limit int, offset int, order string, dir string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error) {
	var (
		orderDirection          string
		employee_leave_requests []model.SelectEmployeeLeaveRequestPICParameter
	)
	orderDirection = order + " " + dir
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, CONCAT(CONCAT(emp.firstname, ' '), emp.lastname) as current_approval_employee_name, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0").Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) SearchEmployeeLeaveRequestPersonaliaPIC(limit int, offset int, order string, dir string, search string) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error) {
	var (
		orderDirection          string
		final                   string
		employee_leave_requests []model.SelectEmployeeLeaveRequestPICParameter
	)
	orderDirection = order + " " + dir
	final = "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, CONCAT(CONCAT(emp.firstname, ' '), emp.lastname) as current_approval_employee_name, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ?) AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) CountSearchEmployeeLeaveRequestPersonaliaPIC(search string) (count int64, err error) {
	final := "%" + strings.ToLower(search) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END) LIKE ? ) AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final).Count(&count)
	return count, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindAllEmployeeLeaveRequestByEmpId(empId uint, year string, date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
		final                   string
	)
	final = "%" + strings.ToLower(year) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND employee_leave_requests.deleted_at = 0 AND (to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'YYYY') LIKE ? OR to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'YYYY') LIKE ?) AND employee_leave_requests.leave_from <= ?", empId, final, final, date).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestFromDate(date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status != 4 AND employee_leave_requests.status != 5 AND employee_leave_requests.status != 6 AND employee_leave_requests.deleted_at = 0 AND employee_leave_requests.leave_from <= ? AND employee_leave_requests.leave_to >= ?", date, date).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestToDate(date float64, date2 float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status != 4 AND employee_leave_requests.status != 5 AND employee_leave_requests.status != 6 AND employee_leave_requests.deleted_at = 0 AND employee_leave_requests.leave_from = ? AND employee_leave_requests.leave_to = ?", date, date2).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestDate(date float64, date2 float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
	)
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD-Mon-YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD-Mon-YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD-Mon-YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.status!=5 AND employee_leave_requests.status != 6 AND employee_leave_requests.deleted_at = 0 AND employee_leave_requests.leave_from <= ? AND employee_leave_requests.leave_to >= ?", date, date2).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

func (db *EmployeeLeaveRequestConnection) FindAllEmployeeLeaveRequestByEmpIdDate(empId uint, year string, date float64) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
	var (
		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
		final                   string
	)
	final = "%" + strings.ToLower(year) + "%"
	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' WHEN employee_leave_requests.status = 6 THEN 'Overwrite' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at, employee_leave_requests.secondary_pic").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.employee_id = ? AND employee_leave_requests.deleted_at = 0 AND (to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'YYYY') LIKE ? OR to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'YYYY') LIKE ?) AND employee_leave_requests.leave_from > ?", empId, final, final, date).Order("employee_leave_requests.id").Find(&employee_leave_requests)
	return employee_leave_requests, res.Error
}

// func (db *EmployeeLeaveRequestConnection) SearchEmployeeLeaveRequestPIC(limit int, offset int, order string, dir string, search string, empId int) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestPICParameter, err error) {
// 	var (
// 		orderDirection          string
// 		final                   string
// 		employee_leave_requests []model.SelectEmployeeLeaveRequestPICParameter
// 	)
// 	orderDirection = order + " " + dir
// 	final = "%" + strings.ToLower(search) + "%"
// 	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Joins("left join employees emp ON employee_leave_requests.current_approval_employee_id = emp.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END) LIKE ?) AND employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Order(orderDirection).Limit(limit).Offset(offset).Find(&employee_leave_requests)
// 	return employee_leave_requests, res.Error
// }

// func (db *EmployeeLeaveRequestConnection) CountSearchEmployeeLeaveRequestPIC(search string, empId int) (count int64, err error) {
// 	final := "%" + strings.ToLower(search) + "%"
// 	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employee_leave_request_approvals.id as employee_leave_request_approval_id,  employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at").Joins("left join employee_leave_request_approvals on employee_leave_requests.id = employee_leave_request_approvals.employee_leave_request_id").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("(lower(employee_leave_requests.employee_leave_request_no) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.created_at::numeric), 'DD Mon YYYY')) LIKE ? OR lower(leave_types.leave_type_name) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY')) LIKE ? OR lower(to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY')) LIKE ? OR lower(employee_leave_requests.leave_credit::varchar(50)) LIKE ? OR lower(employee_leave_requests.remark) LIKE ? OR lower(CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END) LIKE ? ) AND employee_leave_request_approvals.employee_id = ? AND employee_leave_requests.status=2 AND employee_leave_request_approvals.approval_status = 2 AND employee_leave_requests.deleted_at = 0", final, final, final, final, final, final, final, final, empId).Count(&count)
// 	return count, res.Error
// }

// func (db *EmployeeLeaveRequestConnection) FindExcEmployeeLeaveRequest(nwtId uint, id uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
// 	var (
// 		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
// 	)

// 	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.non_working_type_id = ? AND employee_leave_requests.id!=? AND employee_leave_requests.deleted_at = 0", nwtId, id).Order("employee_leave_requests.id").Find(&employee_leave_requests)
// 	return employee_leave_requests, res.Error
// }

// func (db *EmployeeLeaveRequestConnection) FindEmployeeLeaveRequestByNWTId(nwtId uint) (employeeLeaveRequestOutput []model.SelectEmployeeLeaveRequestParameter, err error) {
// 	var (
// 		employee_leave_requests []model.SelectEmployeeLeaveRequestParameter
// 	)

// 	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("employee_leave_requests.non_working_type_id=? AND employee_leave_requests.deleted_at = 0", nwtId).Order("employee_leave_requests.id").Find(&employee_leave_requests)
// 	return employee_leave_requests, res.Error
// }

// func (db *EmployeeLeaveRequestConnection) CountEmployeeLeaveRequestName(search string) (count int64, err error) {
// 	final := "%" + strings.ToLower(search) + "%"
// 	res := db.connection.Table("employee_leave_requests").Select("employee_leave_requests.id, employee_leave_requests.employee_id, employees.firstname, employees.lastname, employee_leave_requests.employee_leave_request_no, to_char(to_timestamp(employee_leave_requests.employee_leave_request_date::numeric), 'DD Mon YYYY') as employee_leave_request_date, employee_leave_requests.leave_type_id, leave_types.leave_type_name, employee_leave_requests.leave_credit,  employee_leave_requests.leave_used, employee_leave_requests.leave_remaining, to_char(to_timestamp(employee_leave_requests.leave_from::numeric), 'DD Mon YYYY') as leave_from, to_char(to_timestamp(employee_leave_requests.leave_to::numeric), 'DD Mon YYYY') as leave_to, employee_leave_requests.address, employee_leave_requests.phone_number, employee_leave_requests.current_approval_sequence_no, employee_leave_requests.current_approval_employee_id, employee_leave_requests.status, CASE WHEN employee_leave_requests.status = 1 THEN 'Draft' WHEN employee_leave_requests.status = 2 THEN 'Ask For Approval' WHEN employee_leave_requests.status = 3 THEN 'Approved' WHEN employee_leave_requests.status = 4 THEN 'Rejected' WHEN employee_leave_requests.status = 5 THEN 'Cancelled' END AS status_name, employee_leave_requests.remark, employee_leave_requests.created_user_id, employee_leave_requests.updated_user_id, employee_leave_requests.deleted_user_id, employee_leave_requests.created_at, employee_leave_requests.updated_at, employee_leave_requests.deleted_at").Joins("left join employees ON employee_leave_requests.employee_id = employees.id").Joins("left join leave_types ON employee_leave_requests.leave_type_id = leave_types.id").Where("lower(non_working_types.non_working_type_name) LIKE ?", final).Count(&count)
// 	return count, res.Error
// }

func (db *EmployeeLeaveRequestConnection) InsertEmployeeLeaveRequest(employeeLeaveRequest model.EmployeeLeaveRequest) (employeeLeaveRequestOutput model.EmployeeLeaveRequest, err error) {
	res := db.connection.Save(&employeeLeaveRequest)
	return employeeLeaveRequest, res.Error
}

func (db *EmployeeLeaveRequestConnection) UpdateEmployeeLeaveRequest(employeeLeaveRequest model.EmployeeLeaveRequest, id uint) (employeeLeaveRequestOutput model.EmployeeLeaveRequest, err error) {
	res := db.connection.Where("id=?", id).Updates(&employeeLeaveRequest)
	return employeeLeaveRequest, res.Error
}
